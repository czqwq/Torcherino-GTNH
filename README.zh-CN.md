# Torcherino-GTNH

[English](README.md) | **简体中文**

> 专为 GregTech: New Horizons (GTNH) 整合包设计的时间加速模组

## 📖 简介

Torcherino 是一个能够加速周围方块运行速度的魔法火把模组。本版本针对 GTNH 整合包进行了特别优化，完美支持 GregTech 机器的加速，让你的自动化工厂运行得更快！

### ✨ 核心特性

- **时间加速**：放置 Torcherino 火把可以加速周围区域内的机器和方块
- **GregTech 优化**：特别支持 GregTech 机器加速，不会导致能量消耗异常或跳电问题
- **多方块结构支持**：完美支持 GregTech 的多方块结构和单方块机器
- **可调节范围**：通过 GUI 界面自由调整加速范围和速度
- **红石控制**：支持红石信号控制开关（Classic 版本）
- **时间之瓶**：便携式单方块加速工具，可存储时间并按需使用

## 🔥 方块类型

模组提供了多种不同强度的 Torcherino 火把：

### 标准版本（带 GUI）

1. **Torcherino（普通火把）**
   - 基础版本的时间加速火把
   - 可通过 GUI 调节加速倍率（0% ~ 400%）
   - 可自定义 X、Y、Z 三个方向的加速范围

2. **Compressed Torcherino（压缩火把）**
   - 中级版本，加速效果更强
   - 可调节加速倍率（0% ~ 900%）
   - 范围和控制方式与普通版本相同

3. **Double Compressed Torcherino（双重压缩火把）**
   - 高级版本，最强的加速效果
   - 可调节加速倍率（0% ~ 8100%）
   - 适合需要极速生产的场景

### Classic 版本（传统模式）

每种火把都有对应的 Classic 版本（Torcherino Classic、Compressed Torcherino Classic、Double Compressed Torcherino Classic）：
- 使用传统的模式切换方式（右键点击切换）
- 支持红石信号控制（接收到红石信号时停止工作）
- 预设多个固定的加速倍率档位

## ⏳ 时间之瓶（Time Vial）

时间之瓶是一个便携式的时间加速工具，可以对单个方块或机器进行临时加速。

### 特性

- **时间存储**：时间之瓶会自动积累时间（每秒 1 秒游戏时间）
- **单点加速**：右键点击方块创建加速实体，对该位置进行时间加速
- **可调倍率**：加速倍率从 4 倍开始，可升级至 128 倍（4x → 8x → 16x → 32x → 64x → 128x）
- **时间消耗**：创建加速实体和升级倍率都会消耗存储的时间
- **时间回收**：Shift + 右键点击现有加速实体可以回收剩余时间

### 使用方法

1. **创建加速实体**
   - 持有时间之瓶右键点击目标方块
   - 消耗 2,400 秒存储时间（40 分钟）
   - 创建一个持续 600 tick（30 秒）的 4 倍速加速实体
   - **Shift + 右键**：创建普通模式加速实体（不使用 GregTech 优化）

2. **升级加速倍率**
   - 对已存在的加速实体右键点击
   - 倍率翻倍（4x → 8x → 16x → 32x → 64x → 128x）
   - 消耗的时间 = 当前倍率 × 剩余时间
   - 最高可升级至 128 倍速

3. **回收时间**
   - **Shift + 右键点击**现有的加速实体
   - 回收剩余的时间到时间之瓶中
   - 回收量 = 当前倍率 × 剩余时间

4. **查看存储时间**
   - 将鼠标悬停在时间之瓶上
   - 显示格式：`时间: X 小时 X 分钟 X 秒`

### 工作原理

- 加速实体每 tick 会对目标位置的 TileEntity 进行多次更新
- 默认使用 GregTech 优化模式，防止能量消耗异常
- 加速实体为隐形实体，大小极小（0.02×0.02 方块）
- 每个加速实体持续 600 tick（30 秒），期间按设定倍率加速目标方块

### 与火把的对比

| 特性 | Torcherino 火把 | 时间之瓶 |
|------|----------------|----------|
| 加速范围 | 可配置的区域（多方块） | 单个方块 |
| 持续时间 | 永久（只要放置） | 临时（600 tick / 30 秒） |
| 便携性 | 需要放置方块 | 可随身携带 |
| 最大倍率 | 最高 8100% | 最高 128 倍 |
| 资源消耗 | 无（放置后） | 消耗存储时间 |

## 🎮 使用方法

### 标准版本火把

1. 放置 Torcherino 火把在需要加速的区域附近
2. 右键点击火把打开 GUI 界面
3. 使用滑动条调整：
   - **Speed（速度）**：调整加速倍率
   - **X/Y/Z Radius（范围）**：调整三个方向的加速半径
4. 加速范围内的机器和方块会按照设定的倍率加快运行

### Classic 版本火把

1. 放置 Classic 版本的 Torcherino 火把
2. 右键点击切换加速模式和速度档位
3. Shift + 右键可以切换不同的速度设置
4. 使用红石信号可以远程控制火把的开关状态

## ⚙️ 配置选项

模组提供了配置文件（位于 `config/Torcherino.cfg`）供高级用户调整：

- **enableAccelerateGregTechMachine**：是否启用 GregTech 机器的高级加速（默认：开启）
- **accelerateGregTechMachineDiscount**：GregTech 机器加速的折扣系数（默认：0.8，范围：0.0-1.0）
  - 该参数用于平衡性能和游戏体验，防止过度加速导致服务器卡顿

## 🔧 技术特性

### GregTech 特别优化

本模组使用了先进的 Mixin 技术来优化 GregTech 机器的加速：
- **防止能量异常**：加速期间不会额外消耗能量或导致跳电
- **智能进度管理**：正确处理机器的工作进度，避免逻辑错误
- **性能限制**：内置性能保护，单次加速不超过 1ms，防止服务器卡顿
- **多方块支持**：特别支持 GregTech 的大型多方块结构（如高级装配线）

### 适配的特殊机器

- GregTech 基础机器和多方块结构
- TecTech 研究站（Research Station）
- 其他实现了加速接口的 Tile Entity

## 📦 依赖要求

- Minecraft 1.7.10
- Minecraft Forge 10.13.4.1614 或更高版本
- GregTech 5（GTNH 版本）推荐但不强制

## 🙏 鸣谢

- 感谢 [MockTurtle7/Torcherino](https://github.com/MockTurtle7/Torcherino) 提供的原始代码
- 感谢 NH-Utilities 提供的加速优化方案
- 感谢 GTNH 开发团队的支持

## 📝 开源协议

本项目遵循原项目的开源协议。详见 [LICENSE](LICENSE) 文件。

## 🔗 相关链接

- 项目地址：https://github.com/czqwq/Torcherino-GTNH
- 问题反馈：https://github.com/czqwq/Torcherino-GTNH/issues

---

**提示**：使用时请注意合理设置加速倍率，过高的加速可能会影响服务器性能。建议在单人游戏中测试后再在服务器上使用。
